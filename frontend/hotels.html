<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Đặt phòng khách sạn - opulent.com</title>
    <!-- Load jQuery trước tiên -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Bootstrap và các thư viện khác -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css"
    />
    <!-- <link rel="stylesheet" href="css/style.css" /> -->
    <style>
      /* Hotel specific styles */
      .hotel-card {
        transition: all 0.3s ease;
        cursor: pointer;
        border: 2px solid transparent;
      }

      .hotel-card:hover {
        transform: translateY(-5px);
        border-color: var(--primary-color);
        box-shadow: 0 10px 25px rgba(13, 110, 253, 0.1);
      }

      .hotel-rating {
        background-color: #ffc107;
        color: #000;
        padding: 2px 8px;
        border-radius: 4px;
        font-weight: bold;
        font-size: 0.9rem;
      }

      .amenity-icon {
        width: 30px;
        height: 30px;
        background-color: #f8f9fa;
        border-radius: 50%;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        margin-right: 10px;
      }

      .price-badge {
        font-size: 1.25rem;
        font-weight: bold;
        color: var(--primary-color);
      }

      .room-card {
        border: 1px solid #dee2e6;
        border-radius: 10px;
        padding: 20px;
        margin-bottom: 20px;
        transition: all 0.3s ease;
      }

      .room-card:hover {
        border-color: var(--primary-color);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      }

      .availability-badge {
        position: absolute;
        top: 15px;
        right: 15px;
        z-index: 1;
      }

      .hotel-gallery {
        height: 300px;
        border-radius: 10px;
        overflow: hidden;
        position: relative;
      }

      .gallery-main {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .gallery-thumbnails {
        position: absolute;
        bottom: 15px;
        left: 15px;
        right: 15px;
        display: flex;
        gap: 10px;
        overflow-x: auto;
      }

      .gallery-thumb {
        width: 80px;
        height: 60px;
        border-radius: 5px;
        object-fit: cover;
        cursor: pointer;
        border: 2px solid transparent;
        transition: all 0.3s ease;
      }

      .gallery-thumb.active {
        border-color: var(--primary-color);
      }

      .date-range-picker {
        background-color: white;
        border: 1px solid #dee2e6;
        border-radius: 8px;
        padding: 15px;
      }

      .date-input-group {
        position: relative;
      }

      .date-input-group i {
        position: absolute;
        left: 15px;
        top: 50%;
        transform: translateY(-50%);
        color: var(--primary-color);
        z-index: 2;
      }

      .date-input-group input {
        padding-left: 45px;
      }

      .filter-option {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 10px 15px;
        border: 1px solid #dee2e6;
        border-radius: 8px;
        margin-bottom: 10px;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .filter-option:hover {
        background-color: #f8f9fa;
        border-color: var(--primary-color);
      }

      .filter-option.active {
        background-color: #e7f1ff;
        border-color: var(--primary-color);
        color: var(--primary-color);
      }

      .star-rating {
        color: #ffc107;
      }

      .no-hotel-found {
        text-align: center;
        padding: 60px 20px;
      }

      .no-hotel-found i {
        font-size: 4rem;
        color: #6c757d;
        margin-bottom: 20px;
      }
    </style>
  </head>
  <body>
    <!-- Navigation -->
    <nav
      class="navbar navbar-expand-lg navbar-light bg-white shadow-sm fixed-top"
    >
      <div class="container">
        <a class="navbar-brand" href="index.html">
          <img src="images/logo.png" alt="Logo" height="40" />
          <span class="brand-text"
            >Opulent<span class="text-primary"></span
          ></span>
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav me-auto">
            <li class="nav-item">
              <a class="nav-link" href="index.html">Trang chủ</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="hotels.html">Khách sạn</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="room.html">Phòng</a>
            </li>
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                data-bs-toggle="dropdown"
              >
                Điểm đến
              </a>
              <ul class="dropdown-menu">
                <li>
                  <a class="dropdown-item" href="hotels.html?city=Ha Noi"
                    >Hà Nội</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" href="hotels.html?city=Da Nang"
                    >Đà Nẵng</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" href="hotels.html?city=Ho Chi Minh"
                    >TP.HCM</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" href="hotels.html?city=Nha Trang"
                    >Nha Trang</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" href="hotels.html?city=Phu Quoc"
                    >Phú Quốc</a
                  >
                </li>
              </ul>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="contact.html">Liên hệ</a>
            </li>
          </ul>
          <div class="d-flex">
            <a href="login/login.html" class="btn btn-outline-primary me-2">
              <i class="fas fa-sign-in-alt"></i> Đăng nhập
            </a>
            <a href="login/register.html" class="btn btn-primary">
              <i class="fas fa-user-plus"></i> Đăng ký
            </a>
          </div>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <div class="container py-5" style="margin-top: 76px">
      <!-- Search Header -->
      <div class="row mb-5">
        <div class="col-12">
          <div class="card border-0 shadow-lg">
            <div class="card-body p-4">
              <h2 class="card-title mb-4">Tìm phòng khách sạn</h2>
              <form id="hotelSearchForm">
                <div class="row g-3">
                  <div class="col-md-3">
                    <label class="form-label">Địa điểm</label>
                    <div class="input-group">
                      <span class="input-group-text"
                        ><i class="fas fa-map-marker-alt"></i
                      ></span>
                      <input
                        type="text"
                        class="form-control"
                        id="searchLocation"
                        placeholder="Thành phố, địa điểm..."
                      />
                    </div>
                  </div>
                  <div class="col-md-3">
                    <label class="form-label">Nhận phòng</label>
                    <div class="date-input-group">
                      <i class="fas fa-calendar-alt"></i>
                      <input
                        type="text"
                        class="form-control datepicker"
                        id="checkInDate"
                        placeholder="Chọn ngày"
                      />
                    </div>
                  </div>
                  <div class="col-md-3">
                    <label class="form-label">Trả phòng</label>
                    <div class="date-input-group">
                      <i class="fas fa-calendar-alt"></i>
                      <input
                        type="text"
                        class="form-control datepicker"
                        id="checkOutDate"
                        placeholder="Chọn ngày"
                      />
                    </div>
                  </div>
                  <div class="col-md-3">
                    <label class="form-label">Số phòng & Khách</label>
                    <div class="input-group">
                      <span class="input-group-text"
                        ><i class="fas fa-user-friends"></i
                      ></span>
                      <select class="form-select" id="roomGuests">
                        <option value="1">1 phòng, 1 khách</option>
                        <option value="2" selected>1 phòng, 2 khách</option>
                        <option value="3">1 phòng, 3 khách</option>
                        <option value="4">2 phòng, 4 khách</option>
                        <option value="6">2 phòng, 6 khách</option>
                      </select>
                    </div>
                  </div>
                  <div class="col-12 mt-3">
                    <button type="submit" class="btn btn-primary btn-lg w-100">
                      <i class="fas fa-search me-2"></i>Tìm khách sạn
                    </button>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <!-- Filters Sidebar -->
        <div class="col-lg-3 mb-4">
          <div class="card border-0 shadow-sm sticky-top" style="top: 90px">
            <div class="card-body">
              <h5 class="card-title mb-4">Bộ lọc</h5>

              <!-- Price Range -->
              <div class="mb-4">
                <h6 class="mb-3">Khoảng giá / đêm</h6>
                <div class="d-flex justify-content-between mb-2">
                  <span id="minPriceLabel">0 VND</span>
                  <span id="maxPriceLabel">5,000,000 VND</span>
                </div>
                <input
                  type="range"
                  class="form-range"
                  min="0"
                  max="5000000"
                  step="500000"
                  id="priceRange"
                  value="5000000"
                />
                <div class="mt-2">
                  <input
                    type="number"
                    class="form-control mb-2"
                    id="minPriceInput"
                    placeholder="Từ"
                    min="0"
                  />
                  <input
                    type="number"
                    class="form-control"
                    id="maxPriceInput"
                    placeholder="Đến"
                    max="5000000"
                  />
                </div>
              </div>

              <!-- Star Rating -->
              <div class="mb-4">
                <h6 class="mb-3">Hạng sao</h6>
                <div id="starRatingFilters">
                  <div class="filter-option" data-rating="5">
                    <div>
                      <div class="star-rating">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                      </div>
                      <small class="text-muted">5 sao</small>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" />
                    </div>
                  </div>
                  <div class="filter-option" data-rating="4">
                    <div>
                      <div class="star-rating">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="far fa-star"></i>
                      </div>
                      <small class="text-muted">4 sao</small>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" />
                    </div>
                  </div>
                  <div class="filter-option" data-rating="3">
                    <div>
                      <div class="star-rating">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="far fa-star"></i>
                        <i class="far fa-star"></i>
                      </div>
                      <small class="text-muted">3 sao</small>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" />
                    </div>
                  </div>
                </div>
              </div>

              <!-- Amenities -->
              <div class="mb-4">
                <h6 class="mb-3">Tiện nghi</h6>
                <div class="form-check mb-2">
                  <input class="form-check-input" type="checkbox" id="wifi" />
                  <label class="form-check-label" for="wifi">
                    <i class="fas fa-wifi text-primary me-2"></i>Wi-Fi miễn phí
                  </label>
                </div>
                <div class="form-check mb-2">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    id="parking"
                  />
                  <label class="form-check-label" for="parking">
                    <i class="fas fa-parking text-primary me-2"></i>Bãi đỗ xe
                  </label>
                </div>
                <div class="form-check mb-2">
                  <input class="form-check-input" type="checkbox" id="pool" />
                  <label class="form-check-label" for="pool">
                    <i class="fas fa-swimming-pool text-primary me-2"></i>Hồ bơi
                  </label>
                </div>
                <div class="form-check mb-2">
                  <input class="form-check-input" type="checkbox" id="spa" />
                  <label class="form-check-label" for="spa">
                    <i class="fas fa-spa text-primary me-2"></i>Spa
                  </label>
                </div>
                <div class="form-check mb-2">
                  <input class="form-check-input" type="checkbox" id="gym" />
                  <label class="form-check-label" for="gym">
                    <i class="fas fa-dumbbell text-primary me-2"></i>Phòng gym
                  </label>
                </div>
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    id="breakfast"
                  />
                  <label class="form-check-label" for="breakfast">
                    <i class="fas fa-utensils text-primary me-2"></i>Bữa sáng
                  </label>
                </div>
              </div>

              <!-- Hotel Type -->
              <div class="mb-4">
                <h6 class="mb-3">Loại khách sạn</h6>
                <div class="form-check mb-2">
                  <input
                    class="form-check-input"
                    type="radio"
                    name="hotelType"
                    id="hotelTypeAll"
                    checked
                  />
                  <label class="form-check-label" for="hotelTypeAll">
                    Tất cả
                  </label>
                </div>
                <div class="form-check mb-2">
                  <input
                    class="form-check-input"
                    type="radio"
                    name="hotelType"
                    id="hotelTypeResort"
                  />
                  <label class="form-check-label" for="hotelTypeResort">
                    Resort
                  </label>
                </div>
                <div class="form-check mb-2">
                  <input
                    class="form-check-input"
                    type="radio"
                    name="hotelType"
                    id="hotelTypeBoutique"
                  />
                  <label class="form-check-label" for="hotelTypeBoutique">
                    Khách sạn boutique
                  </label>
                </div>
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="radio"
                    name="hotelType"
                    id="hotelTypeBudget"
                  />
                  <label class="form-check-label" for="hotelTypeBudget">
                    Khách sạn bình dân
                  </label>
                </div>
              </div>

              <!-- Reset & Apply -->
              <div class="d-grid gap-2">
                <button class="btn btn-primary" id="applyHotelFilters">
                  Áp dụng bộ lọc
                </button>
                <button
                  class="btn btn-outline-secondary"
                  id="resetHotelFilters"
                >
                  Đặt lại
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Hotels List -->
        <div class="col-lg-9">
          <!-- Results Header -->
          <div class="row mb-4">
            <div class="col">
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <h4 class="mb-1" id="hotelsCount">Đang tải...</h4>
                  <small class="text-muted" id="searchLocationText"></small>
                </div>
                <div class="d-flex align-items-center">
                  <span class="me-2">Sắp xếp:</span>
                  <select
                    class="form-select form-select-sm w-auto"
                    id="sortHotels"
                  >
                    <option value="recommended">Được đề xuất</option>
                    <option value="price_asc">Giá thấp đến cao</option>
                    <option value="price_desc">Giá cao đến thấp</option>
                    <option value="rating_desc">Đánh giá cao nhất</option>
                    <option value="stars_desc">Hạng sao cao nhất</option>
                  </select>
                </div>
              </div>
            </div>
          </div>

          <!-- Loading -->
          <div id="loadingHotels" class="text-center py-5">
            <div class="spinner-border text-primary" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
            <p class="mt-3">Đang tải danh sách khách sạn...</p>
          </div>

          <!-- Hotels Grid -->
          <div id="hotelsGrid" class="row">
            <!-- Hotels will be loaded here -->
          </div>

          <!-- No Results -->
          <div id="noHotelsFound" class="no-hotel-found d-none">
            <i class="fas fa-hotel"></i>
            <h4 class="mb-3">Không tìm thấy khách sạn phù hợp</h4>
            <p class="text-muted mb-4">
              Hãy thử thay đổi bộ lọc hoặc tìm kiếm với địa điểm khác
            </p>
            <button class="btn btn-outline-primary" id="resetSearchBtn">
              <i class="fas fa-redo me-2"></i>Đặt lại tìm kiếm
            </button>
          </div>

          <!-- Pagination -->
          <nav aria-label="Page navigation" class="mt-5" id="hotelPagination">
            <ul class="pagination justify-content-center">
              <!-- Pagination will be generated here -->
            </ul>
          </nav>
        </div>
      </div>
    </div>

    <!-- Hotel Detail Modal -->
    <div
      class="modal fade"
      id="hotelDetailModal"
      tabindex="-1"
      aria-labelledby="hotelDetailModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-xl modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="hotelDetailModalLabel">
              Chi tiết khách sạn
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body p-4">
            <!-- Content will be loaded dynamically -->
          </div>
        </div>
      </div>
    </div>

    <!-- Booking Modal -->
    <div
      class="modal fade"
      id="bookingModal"
      tabindex="-1"
      aria-labelledby="bookingModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="bookingModalLabel">
              Đặt phòng khách sạn
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            <!-- Booking form will be loaded dynamically -->
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="bg-dark text-white py-5">
      <div class="container">
        <div class="row">
          <div class="col-lg-4 mb-4">
            <h5 class="mb-3">TourDuLich.com</h5>
            <p class="text-muted">
              Đặt phòng khách sạn nhanh chóng, giá tốt nhất với hơn 10,000 khách
              sạn trên toàn quốc.
            </p>
            <div class="social-icons mt-3">
              <a href="#" class="text-white me-3"
                ><i class="fab fa-facebook-f"></i
              ></a>
              <a href="#" class="text-white me-3"
                ><i class="fab fa-twitter"></i
              ></a>
              <a href="#" class="text-white me-3"
                ><i class="fab fa-instagram"></i
              ></a>
              <a href="#" class="text-white"><i class="fab fa-youtube"></i></a>
            </div>
          </div>
          <div class="col-lg-2 col-6 mb-4">
            <h6 class="mb-3">Khách sạn</h6>
            <ul class="list-unstyled">
              <li class="mb-2">
                <a
                  href="hotels.html?city=Ha Noi"
                  class="text-muted text-decoration-none"
                  >Hà Nội</a
                >
              </li>
              <li class="mb-2">
                <a
                  href="hotels.html?city=Da Nang"
                  class="text-muted text-decoration-none"
                  >Đà Nẵng</a
                >
              </li>
              <li class="mb-2">
                <a
                  href="hotels.html?city=Ho Chi Minh"
                  class="text-muted text-decoration-none"
                  >TP.HCM</a
                >
              </li>
              <li class="mb-2">
                <a
                  href="hotels.html?city=Phu Quoc"
                  class="text-muted text-decoration-none"
                  >Phú Quốc</a
                >
              </li>
            </ul>
          </div>
          <div class="col-lg-3 col-6 mb-4">
            <h6 class="mb-3">Hỗ trợ</h6>
            <ul class="list-unstyled">
              <li class="mb-2">
                <a href="faq.html" class="text-muted text-decoration-none"
                  >Câu hỏi thường gặp</a
                >
              </li>
              <li class="mb-2">
                <a href="contact.html" class="text-muted text-decoration-none"
                  >Liên hệ đặt phòng</a
                >
              </li>
              <li class="mb-2">
                <a href="terms.html" class="text-muted text-decoration-none"
                  >Điều khoản đặt phòng</a
                >
              </li>
              <li class="mb-2">
                <a href="privacy.html" class="text-muted text-decoration-none"
                  >Chính sách bảo mật</a
                >
              </li>
            </ul>
          </div>
          <div class="col-lg-3 mb-4">
            <h6 class="mb-3">Hỗ trợ 24/7</h6>
            <p class="text-muted small">Gọi ngay để được tư vấn và đặt phòng</p>
            <div class="mb-3">
              <h4 class="text-warning">1900 1234</h4>
              <small class="text-muted">Miễn phí cuộc gọi</small>
            </div>
            <div class="input-group">
              <input
                type="email"
                class="form-control"
                placeholder="Email nhận ưu đãi"
              />
              <button class="btn btn-primary">Đăng ký</button>
            </div>
          </div>
        </div>
        <hr class="bg-secondary" />
        <div class="row pt-3">
          <div class="col-md-6">
            <p class="mb-0 text-muted">
              © 2024 TourDuLich.com. All rights reserved.
            </p>
          </div>
          <div class="col-md-6 text-md-end">
            <img
              src="images/payment-methods.png"
              alt="Payment Methods"
              height="30"
            />
          </div>
        </div>
      </div>
    </footer>

    <!-- JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/locales/bootstrap-datepicker.vi.min.js"></script>

    <!-- Load api-client.js từ đúng thư mục -->
    <script src="api/api-client.js"></script>
    <script>
      // Tạo object global cho hotelManager
      window.hotelManager = null;
      document.addEventListener("DOMContentLoaded", function () {
        // Initialize date pickers
        $(".datepicker").datepicker({
          format: "dd/mm/yyyy",
          language: "vi",
          autoclose: true,
          todayHighlight: true,
          startDate: new Date(),
        });

        // Set default dates (today and tomorrow)
        const today = new Date();
        const tomorrow = new Date(today);
        tomorrow.setDate(tomorrow.getDate() + 1);

        const formatDateForInput = (date) => {
          const day = String(date.getDate()).padStart(2, "0");
          const month = String(date.getMonth() + 1).padStart(2, "0");
          const year = date.getFullYear();
          return `${day}/${month}/${year}`;
        };

        $("#checkInDate").val(formatDateForInput(today));
        $("#checkOutDate").val(formatDateForInput(tomorrow));

        // Initialize hotel manager
        const hotelManager = new HotelManager();

        // Đọc tham số từ URL
        const urlParams = new URLSearchParams(window.location.search);
        const cityParam = urlParams.get("city");

        if (cityParam) {
          // Điền vào ô tìm kiếm
          const decodedCity = decodeURIComponent(cityParam);
          document.getElementById("searchLocation").value = decodedCity;
          document.getElementById(
            "searchLocationText"
          ).textContent = `Kết quả tìm kiếm cho "${decodedCity}"`;

          // Tự động tìm kiếm
          setTimeout(() => {
            hotelManager.searchHotels();
          }, 100);
        } else {
          hotelManager.init();
        }

        // Search form submission
        document
          .getElementById("hotelSearchForm")
          .addEventListener("submit", function (e) {
            e.preventDefault();
            hotelManager.searchHotels();
          });

        // Filter option click handlers
        document.querySelectorAll(".filter-option").forEach((option) => {
          option.addEventListener("click", function () {
            const checkbox = this.querySelector('input[type="checkbox"]');
            checkbox.checked = !checkbox.checked;
            this.classList.toggle("active", checkbox.checked);
          });
        });

        // Apply filters
        document
          .getElementById("applyHotelFilters")
          .addEventListener("click", function () {
            hotelManager.applyFilters();
          });

        // Reset filters
        document
          .getElementById("resetHotelFilters")
          .addEventListener("click", function () {
            hotelManager.resetFilters();
          });

        // Reset search
        document
          .getElementById("resetSearchBtn")
          ?.addEventListener("click", function () {
            hotelManager.resetFilters();
          });

        // Sort hotels
        document
          .getElementById("sortHotels")
          .addEventListener("change", function () {
            hotelManager.sortHotels(this.value);
          });

        // Price range slider
        const priceRange = document.getElementById("priceRange");
        const minPriceLabel = document.getElementById("minPriceLabel");
        const maxPriceLabel = document.getElementById("maxPriceLabel");
        const minPriceInput = document.getElementById("minPriceInput");
        const maxPriceInput = document.getElementById("maxPriceInput");

        function updatePriceLabels() {
          const maxPrice = parseInt(priceRange.value);
          const formattedMaxPrice = new Intl.NumberFormat("vi-VN").format(
            maxPrice
          );
          maxPriceLabel.textContent = `${formattedMaxPrice} VND`;

          if (minPriceInput.value) {
            const formattedMinPrice = new Intl.NumberFormat("vi-VN").format(
              minPriceInput.value
            );
            minPriceLabel.textContent = `${formattedMinPrice} VND`;
          }
        }

        priceRange.addEventListener("input", updatePriceLabels);
        minPriceInput.addEventListener("input", updatePriceLabels);
        maxPriceInput.addEventListener("input", function () {
          priceRange.value = this.value;
          updatePriceLabels();
        });
      });

      // Hotel Manager Class với API thật
      // Tạo object global cho hotelManager
      window.hotelManager = null;

      document.addEventListener("DOMContentLoaded", function () {
        // Initialize date pickers với jQuery
        $(".datepicker").datepicker({
          format: "dd/mm/yyyy",
          language: "vi",
          autoclose: true,
          todayHighlight: true,
          startDate: new Date(),
        });

        // Set default dates
        const today = new Date();
        const tomorrow = new Date(today);
        tomorrow.setDate(tomorrow.getDate() + 1);

        const formatDateForInput = (date) => {
          const day = String(date.getDate()).padStart(2, "0");
          const month = String(date.getMonth() + 1).padStart(2, "0");
          const year = date.getFullYear();
          return `${day}/${month}/${year}`;
        };

        $("#checkInDate").val(formatDateForInput(today));
        $("#checkOutDate").val(formatDateForInput(tomorrow));

        // Đọc tham số từ URL
        const urlParams = new URLSearchParams(window.location.search);
        const cityParam = urlParams.get("city");

        if (cityParam) {
          const decodedCity = decodeURIComponent(cityParam);
          document.getElementById("searchLocation").value = decodedCity;
          document.getElementById(
            "searchLocationText"
          ).textContent = `Kết quả tìm kiếm cho "${decodedCity}"`;
        }

        // Khởi tạo HotelManager (SIMPLE VERSION - không dùng API)
        window.hotelManager = new HotelManager();

        // Tự động tìm kiếm nếu có city param
        if (cityParam) {
          setTimeout(() => {
            window.hotelManager.searchHotels();
          }, 100);
        } else {
          window.hotelManager.loadHotels();
        }

        // Search form submission
        document
          .getElementById("hotelSearchForm")
          .addEventListener("submit", function (e) {
            e.preventDefault();
            window.hotelManager.searchHotels();
          });

        // Filter option click handlers
        document.querySelectorAll(".filter-option").forEach((option) => {
          option.addEventListener("click", function () {
            const checkbox = this.querySelector('input[type="checkbox"]');
            checkbox.checked = !checkbox.checked;
            this.classList.toggle("active", checkbox.checked);
          });
        });

        // Apply filters
        document
          .getElementById("applyHotelFilters")
          .addEventListener("click", function () {
            window.hotelManager.applyFilters();
          });

        // Reset filters
        document
          .getElementById("resetHotelFilters")
          .addEventListener("click", function () {
            window.hotelManager.resetFilters();
          });

        // Reset search
        document
          .getElementById("resetSearchBtn")
          ?.addEventListener("click", function () {
            window.hotelManager.resetFilters();
          });

        // Sort hotels
        document
          .getElementById("sortHotels")
          .addEventListener("change", function () {
            window.hotelManager.sortHotels(this.value);
          });
      });

      // SIMPLE Hotel Manager Class - KHÔNG DÙNG API, chỉ dùng mock data
      class HotelManager {
        constructor() {
          this.hotels = [];
          this.filteredHotels = [];
          this.currentPage = 1;
          this.itemsPerPage = 6;

          // Mock data trực tiếp (không cần apiClient)
          this.mockHotels = [
            {
              id: 1,
              name: "Khách Sạn Sheraton Hà Nội",
              address: "Quận Tây Hồ, Hà Nội",
              city: "Hà Nội",
              rating: 4.8,
              stars: 5,
              min_price: 3200000,
              rooms_available: 15,
              images: [
                "https://images.unsplash.com/photo-1566073771259-6a8506099945?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=60",
              ],
              amenities: ["wifi", "parking", "pool", "spa", "gym", "breakfast"],
              description:
                "Khách sạn 5 sao sang trọng với view hồ Tây tuyệt đẹp",
            },
            {
              id: 2,
              name: "Vinpearl Resort & Golf Phú Quốc",
              address: "Gành Dầu, Phú Quốc",
              city: "Phú Quốc",
              rating: 4.7,
              stars: 5,
              min_price: 2800000,
              rooms_available: 22,
              images: [
                "https://images.unsplash.com/photo-1552465011-b4e30bf7349d?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=60",
              ],
              amenities: [
                "wifi",
                "pool",
                "spa",
                "gym",
                "breakfast",
                "airport_shuttle",
              ],
              description:
                "Khu nghỉ dưỡng 5 sao với sân golf và bãi biển riêng",
            },
            {
              id: 3,
              name: "Ana Mandara Villas Đà Lạt Resort & Spa",
              address: "Phường 5, Đà Lạt",
              city: "Đà Lạt",
              rating: 4.6,
              stars: 5,
              min_price: 2400000,
              rooms_available: 18,
              images: [
                "https://images.unsplash.com/photo-1520250497591-112f2f40a3f4?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=60",
              ],
              amenities: ["wifi", "parking", "spa", "garden", "breakfast"],
              description: "Biệt thự nghỉ dưỡng sang trọng giữa rừng thông",
            },
            {
              id: 4,
              name: "The Imperial Hotel Vũng Tàu",
              address: "Thùy Vân, Vũng Tàu",
              city: "Vũng Tàu",
              rating: 4.5,
              stars: 5,
              min_price: 2600000,
              rooms_available: 20,
              images: [
                "https://images.unsplash.com/photo-1564501049418-3c27787d01e8?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=60",
              ],
              amenities: [
                "wifi",
                "pool",
                "spa",
                "gym",
                "beachfront",
                "breakfast",
              ],
              description: "Khách sạn 5 sao view biển tuyệt đẹp",
            },
            {
              id: 5,
              name: "Fleur de Lys Hotel Quy Nhơn",
              address: "Nguyễn Huệ, Quy Nhơn",
              city: "Quy Nhơn",
              rating: 4.4,
              stars: 4,
              min_price: 1500000,
              rooms_available: 25,
              images: [
                "https://images.unsplash.com/photo-1512917774080-9991f1c4c750?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=60",
              ],
              amenities: ["wifi", "parking", "pool", "gym", "breakfast"],
              description: "Khách sạn 4 sao với kiến trúc Pháp cổ điển",
            },
            {
              id: 6,
              name: "InterContinental Nha Trang",
              address: "Trần Phú, Nha Trang",
              city: "Nha Trang",
              rating: 4.7,
              stars: 5,
              min_price: 2700000,
              rooms_available: 30,
              images: [
                "https://images.unsplash.com/photo-1571003123894-1f0594d2b5d9?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=60",
              ],
              amenities: [
                "wifi",
                "spa",
                "pool",
                "gym",
                "beachfront",
                "breakfast",
              ],
              description: "Khách sạn 5 sao trên bãi biển đẹp nhất Nha Trang",
            },
          ];
        }

        async loadHotels() {
          try {
            console.log("Đang tải danh sách khách sạn...");

            // Show loading
            document.getElementById("loadingHotels").classList.remove("d-none");
            document.getElementById("hotelsGrid").innerHTML = "";
            document.getElementById("noHotelsFound").classList.add("d-none");

            // Get search parameters
            const location = document.getElementById("searchLocation").value;
            console.log("Địa điểm tìm kiếm:", location);

            // Sử dụng mock data
            this.hotels = this.mockHotels;

            // Lọc theo thành phố nếu có
            if (location && location.trim() !== "") {
              const searchTerm = location.toLowerCase();
              this.filteredHotels = this.hotels.filter(
                (hotel) =>
                  hotel.city && hotel.city.toLowerCase().includes(searchTerm)
              );
              console.log(
                "Đã lọc theo thành phố:",
                this.filteredHotels.length,
                "khách sạn"
              );
            } else {
              this.filteredHotels = [...this.hotels];
            }

            // Update UI
            this.updateHotelsList();
            this.updateResultsCount();
          } catch (error) {
            console.error("Error loading hotels:", error);
            this.showNoHotelsFound();
          } finally {
            document.getElementById("loadingHotels").classList.add("d-none");
          }
        }

        searchHotels() {
          this.loadHotels();
        }

        updateHotelsList() {
          const container = document.getElementById("hotelsGrid");
          container.innerHTML = "";

          if (this.filteredHotels.length === 0) {
            this.showNoHotelsFound();
            return;
          }

          this.filteredHotels.forEach((hotel) => {
            const hotelCard = this.createHotelCard(hotel);
            container.innerHTML += hotelCard;
          });

          // Add event listeners to hotel cards
          this.addHotelCardListeners();
        }

        createHotelCard(hotel) {
          const price = hotel.min_price
            ? new Intl.NumberFormat("vi-VN", {
                style: "currency",
                currency: "VND",
              }).format(hotel.min_price)
            : "Liên hệ";

          const stars = "★".repeat(hotel.stars) + "☆".repeat(5 - hotel.stars);

          // Get first image
          const firstImage =
            hotel.images && hotel.images.length > 0
              ? hotel.images[0]
              : "https://via.placeholder.com/300x200?text=Hotel+Image";

          return `
            <div class="col-md-6 col-lg-4 mb-4">
                <div class="card hotel-card h-100 border-0 shadow-sm" data-hotel-id="${
                  hotel.id
                }">
                    <div class="position-relative">
                        <img src="${firstImage}" 
                             class="card-img-top" alt="${hotel.name}" 
                             style="height: 200px; object-fit: cover;">
                        <span class="availability-badge">
                            <span class="badge bg-${
                              hotel.rooms_available > 0 ? "success" : "danger"
                            }">
                                ${
                                  hotel.rooms_available > 0
                                    ? `${hotel.rooms_available} phòng còn`
                                    : "Hết phòng"
                                }
                            </span>
                        </span>
                    </div>
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-start mb-2">
                            <h6 class="card-title mb-0">${hotel.name}</h6>
                            <div class="hotel-rating">
                                ${hotel.rating.toFixed(1)}
                                <i class="fas fa-star ms-1" style="font-size: 0.8rem;"></i>
                            </div>
                        </div>
                        <p class="card-text text-muted small mb-2">
                            <i class="fas fa-map-marker-alt text-primary me-1"></i> 
                            ${hotel.address || hotel.city}
                        </p>
                        <div class="mb-3">
                            <span class="star-rating">${stars}</span>
                            <small class="text-muted ms-2">${
                              hotel.stars
                            } sao</small>
                        </div>
                        <p class="card-text small mb-3 text-truncate" title="${
                          hotel.description
                        }">
                            ${hotel.description}
                        </p>
                        <div class="d-flex justify-content-between align-items-center mt-auto">
                            <div>
                                <h5 class="price-badge mb-0">${price}</h5>
                                <small class="text-muted">/đêm</small>
                            </div>
                            <button class="btn btn-sm btn-primary book-room-btn" data-hotel-id="${
                              hotel.id
                            }" ${hotel.rooms_available === 0 ? "disabled" : ""}>
                                <i class="fas fa-calendar-check me-1"></i> Đặt phòng
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        `;
        }

        addHotelCardListeners() {
          // Hotel card click
          document.querySelectorAll(".hotel-card").forEach((card) => {
            card.addEventListener("click", (e) => {
              if (!e.target.closest(".book-room-btn")) {
                const hotelId = card.dataset.hotelId;
                this.showHotelDetail(hotelId);
              }
            });
          });

          // Book room button click
          document.querySelectorAll(".book-room-btn").forEach((btn) => {
            btn.addEventListener("click", (e) => {
              e.stopPropagation();
              const hotelId = btn.dataset.hotelId;
              this.showBookingForm(hotelId);
            });
          });
        }

        updateResultsCount() {
          const count = this.filteredHotels.length;
          document.getElementById(
            "hotelsCount"
          ).textContent = `${count} khách sạn được tìm thấy`;
        }

        showNoHotelsFound() {
          document.getElementById("hotelsGrid").innerHTML = "";
          document.getElementById("noHotelsFound").classList.remove("d-none");
          document.getElementById("hotelsCount").textContent =
            "0 khách sạn được tìm thấy";
        }

        applyFilters() {
          console.log("Áp dụng bộ lọc (đơn giản)");
          // Đơn giản: chỉ load lại
          this.loadHotels();
        }

        resetFilters() {
          console.log("Reset bộ lọc");
          document.getElementById("searchLocation").value = "";
          this.loadHotels();
        }

        sortHotels(sortBy) {
          console.log("Sắp xếp theo:", sortBy);
          // Đơn giản: chỉ load lại
          this.loadHotels();
        }

        // Các phương thức khác có thể giữ nguyên hoặc đơn giản hóa
        showHotelDetail(hotelId) {
          const hotel = this.hotels.find((h) => h.id == hotelId);
          if (!hotel) return;

          alert(
            `Chi tiết khách sạn: ${hotel.name}\n${hotel.description}\nGiá: ${hotel.min_price} VND/đêm`
          );
        }

        showBookingForm(hotelId) {
          const hotel = this.hotels.find((h) => h.id == hotelId);
          if (!hotel) return;

          alert(
            `Đặt phòng: ${hotel.name}\nChức năng đặt phòng sẽ được phát triển sau!`
          );
        }
      }

      // Make HotelManager available globally
      window.HotelManager = HotelManager;
    </script>
  </body>
</html>
